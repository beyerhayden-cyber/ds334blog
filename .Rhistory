weighted_pct |>
ggplot(aes(x = reorder(category, pct_weighted), y = pct_weighted)) +
geom_col(fill = "steelblue") +
coord_flip() +
geom_text(aes(label = round(pct_weighted, 1)), hjust = -0.1) +
scale_y_continuous(limits = c(0, 100)) +
labs(
title = "Weighted National Enrollment by Category",
x = "Category",
y = "Percent of Total Enrollment"
) +
theme_bw()
# Chunk 5
ti <- tuition_income |>
filter(!is.na(net_cost), !is.na(total_price)) |>
mutate(pay_share = net_cost / total_price)
trend <- ti |>
group_by(year, income_lvl) |>
summarise(avg_share = mean(pay_share, na.rm = TRUE), .groups = "drop")
# Chunk 6
ggplot(trend, aes(x = year, y = avg_share, color = income_lvl)) +
geom_line(linewidth = 1.5) +
labs(
title = "Affordability Gap Over Time by Income Level",
x = "Year",
y = "Ratio of sticker price paid",
color = "Income bracket"
) +
theme_bw()
# Chunk 7
tc_summary <- tuition_cost |>
group_by(type) |>
summarise(
avg_in_state = mean(in_state_total, na.rm = TRUE),
avg_out_state = mean(out_of_state_total, na.rm = TRUE),
.groups = "drop"
)
tc_long <- tc_summary |>
pivot_longer(
cols = c(avg_in_state, avg_out_state),
names_to = "tuition_type",
values_to = "cost"
)
# Chunk 8
ggplot(tc_long, aes(x = type, y = cost, fill = tuition_type)) +
geom_col(position = "dodge") +
labs(
title = "Average Sticker Price by School Type",
x = "School type",
y = "Average total cost (USD)",
fill = "Tuition type"
) +
theme_bw()
# Chunk 9
historical_inf_timeline <- historical_tuition %>%
filter(tuition_type == "All Constant")
# Chunk 10
ggplot(historical_inf_timeline, aes(x = year, y = tuition_cost, colour = type)) +
geom_point() +
labs(
title = "Tuition Costs Over Time (Inflation-Adjusted)",
x = "Year",
y = "Tuition cost (inflation-adjusted USD)",
colour = "School type"
) +
theme_minimal()
# Chunk 11
historical_tuition_2yv4y <- historical_tuition %>%
filter(tuition_type %in% c("4 Year Constant", "2 Year Constant")) %>%
filter(year %in% c("1985-86", "1995-96", "2005-06", "2015-16")) %>%
mutate(year = factor(year, levels = c("1985-86", "1995-96", "2005-06", "2015-16")))
# Chunk 12
ggplot(historical_tuition_2yv4y,
aes(x = year, y = tuition_cost, fill = tuition_type)) +
geom_col(position = "dodge") +
facet_wrap(~type) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(
title = "Tuition Costs Over Time",
x = "Year",
y = "Tuition cost (inflation-adjusted USD)",
fill = "Tuition type"
)
# Chunk 13
ggplot(salary_potential,
aes(x = make_world_better_percent, y = mid_career_pay)) +
geom_point() +
labs(
title = "Salary vs Making the World a Better Place",
x = "Percent of alumni who think they are making the world a better place",
y = "Estimated mid-career pay in USD"
) +
theme_bw()
state_salary_potential <- salary_potential |>
group_by(state_name) |>
summarise(avg_mid_career_pay = mean(mid_career_pay, na.rm = TRUE), .groups = "drop")
library(maps)
state_df <- ggplot2::map_data("state")
state_salary_potential <- state_salary_potential |>
mutate(state_name = str_to_lower(state_name)) |>
mutate(state_name = str_replace_all(state_name, "-", " "))
state_full <- right_join(state_df, state_salary_potential, by = c("region" = "state_name"))
ggplot(state_full, aes(x = long, y = lat, group = group)) +
geom_polygon(colour = "black", aes(fill = avg_mid_career_pay)) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
scale_fill_viridis_c(option = "magma") +
theme_bw()
state_world_potential <- salary_potential |>
group_by(state_name) |>
summarise(avg_percent_world_postive = mean(make_world_better_percent, na.rm = TRUE), .groups = "drop")
library(maps)
state_df2 <- ggplot2::map_data("state")
state_world_potential <- state_world_potential |>
mutate(state_name = str_to_lower(state_name)) |>
mutate(state_name = str_replace_all(state_name, "-", " "))
state_full2 <- right_join(state_df2, state_world_potential, by = c("region" = "state_name"))
ggplot(state_full2, aes(x = long, y = lat, group = group)) +
geom_polygon(colour = "black", aes(fill = avg_percent_world_postive)) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
scale_fill_viridis_c(option = "magma") +
theme_bw()
ggplot(state_full2, aes(x = long, y = lat, group = group)) +
geom_polygon(colour = "black", aes(fill = avg_percent_world_postive)) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
scale_fill_viridis_c(option = "magma") +
theme_bw()
ggplot(state_full, aes(x = long, y = lat, group = group)) +
geom_polygon(colour = "black", aes(fill = avg_mid_career_pay)) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
scale_fill_viridis_c(option = "magma") +
theme_bw()
ggplot(state_full2, aes(x = long, y = lat, group = group)) +
geom_polygon(colour = "black", aes(fill = avg_percent_world_postive)) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
scale_fill_viridis_c(option = "magma") +
theme_bw()
View(state_salary_potential)
# Chunk 1
library(tidyverse)
library(tidytuesdayR)
# Chunk 2
tuition_cost <- readr::read_csv(
"https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2020/2020-03-10/tuition_cost.csv",
show_col_types = FALSE)
tuition_income <- readr::read_csv(
"https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2020/2020-03-10/tuition_income.csv",
show_col_types = FALSE)
salary_potential <- readr::read_csv(
"https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2020/2020-03-10/salary_potential.csv",
show_col_types = FALSE)
historical_tuition <- readr::read_csv(
"https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2020/2020-03-10/historical_tuition.csv",
show_col_types = FALSE)
diversity_school <- readr::read_csv(
"https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2020/2020-03-10/diversity_school.csv",
show_col_types = FALSE)
# Chunk 3
percent_category <- diversity_school |>
mutate(pct = enrollment / total_enrollment * 100)
weighted_pct <- percent_category |>
group_by(category) |>
summarise(
total_enrollment_all = sum(total_enrollment, na.rm = TRUE),
total_in_category = sum(enrollment, na.rm = TRUE),
pct_weighted = 100 * total_in_category / total_enrollment_all,
.groups = "drop"
) |>
arrange(desc(pct_weighted))
weighted_pct
# Chunk 4
weighted_pct |>
ggplot(aes(x = reorder(category, pct_weighted), y = pct_weighted)) +
geom_col(fill = "steelblue") +
coord_flip() +
geom_text(aes(label = round(pct_weighted, 1)), hjust = -0.1) +
scale_y_continuous(limits = c(0, 100)) +
labs(
title = "Weighted National Enrollment by Category",
x = "Category",
y = "Percent of Total Enrollment"
) +
theme_bw()
# Chunk 5
ti <- tuition_income |>
filter(!is.na(net_cost), !is.na(total_price)) |>
mutate(pay_share = net_cost / total_price)
trend <- ti |>
group_by(year, income_lvl) |>
summarise(avg_share = mean(pay_share, na.rm = TRUE), .groups = "drop")
# Chunk 6
ggplot(trend, aes(x = year, y = avg_share, color = income_lvl)) +
geom_line(linewidth = 1.5) +
labs(
title = "Affordability Gap Over Time by Income Level",
x = "Year",
y = "Ratio of sticker price paid",
color = "Income bracket"
) +
theme_bw()
# Chunk 7
tc_summary <- tuition_cost |>
group_by(type) |>
summarise(
avg_in_state = mean(in_state_total, na.rm = TRUE),
avg_out_state = mean(out_of_state_total, na.rm = TRUE),
.groups = "drop"
)
tc_long <- tc_summary |>
pivot_longer(
cols = c(avg_in_state, avg_out_state),
names_to = "tuition_type",
values_to = "cost"
)
# Chunk 8
ggplot(tc_long, aes(x = type, y = cost, fill = tuition_type)) +
geom_col(position = "dodge") +
labs(
title = "Average Sticker Price by School Type",
x = "School type",
y = "Average total cost (USD)",
fill = "Tuition type"
) +
theme_bw()
# Chunk 9
historical_inf_timeline <- historical_tuition %>%
filter(tuition_type == "All Constant")
# Chunk 10
ggplot(historical_inf_timeline, aes(x = year, y = tuition_cost, colour = type)) +
geom_point() +
labs(
title = "Tuition Costs Over Time (Inflation-Adjusted)",
x = "Year",
y = "Tuition cost (inflation-adjusted USD)",
colour = "School type"
) +
theme_minimal()
# Chunk 11
historical_tuition_2yv4y <- historical_tuition %>%
filter(tuition_type %in% c("4 Year Constant", "2 Year Constant")) %>%
filter(year %in% c("1985-86", "1995-96", "2005-06", "2015-16")) %>%
mutate(year = factor(year, levels = c("1985-86", "1995-96", "2005-06", "2015-16")))
# Chunk 12
ggplot(historical_tuition_2yv4y,
aes(x = year, y = tuition_cost, fill = tuition_type)) +
geom_col(position = "dodge") +
facet_wrap(~type) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(
title = "Tuition Costs Over Time",
x = "Year",
y = "Tuition cost (inflation-adjusted USD)",
fill = "Tuition type"
)
# Chunk 13
ggplot(salary_potential,
aes(x = make_world_better_percent, y = mid_career_pay)) +
geom_point() +
labs(
title = "Salary vs Making the World a Better Place",
x = "Percent of alumni who think they are making the world a better place",
y = "Estimated mid-career pay in USD"
) +
theme_bw()
# Chunk 14
state_salary_potential <- salary_potential |>
group_by(state_name) |>
summarise(avg_mid_career_pay = mean(mid_career_pay, na.rm = TRUE), .groups = "drop")
# Chunk 15
library(maps)
state_df <- ggplot2::map_data("state")
state_salary_potential <- state_salary_potential |>
mutate(state_name = str_to_lower(state_name)) |>
mutate(state_name = str_replace_all(state_name, "-", " "))
# Chunk 16
state_full <- right_join(state_df, state_salary_potential, by = c("region" = "state_name"))
ggplot(state_full, aes(x = long, y = lat, group = group)) +
geom_polygon(colour = "black", aes(fill = avg_mid_career_pay)) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
scale_fill_viridis_c(option = "magma") +
theme_bw()
# Chunk 1
library(tidyverse)
library(tidytuesdayR)
# Chunk 2
tuition_cost <- readr::read_csv(
"https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2020/2020-03-10/tuition_cost.csv",
show_col_types = FALSE)
tuition_income <- readr::read_csv(
"https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2020/2020-03-10/tuition_income.csv",
show_col_types = FALSE)
salary_potential <- readr::read_csv(
"https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2020/2020-03-10/salary_potential.csv",
show_col_types = FALSE)
historical_tuition <- readr::read_csv(
"https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2020/2020-03-10/historical_tuition.csv",
show_col_types = FALSE)
diversity_school <- readr::read_csv(
"https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2020/2020-03-10/diversity_school.csv",
show_col_types = FALSE)
# Chunk 3
percent_category <- diversity_school |>
mutate(pct = enrollment / total_enrollment * 100)
weighted_pct <- percent_category |>
group_by(category) |>
summarise(
total_enrollment_all = sum(total_enrollment, na.rm = TRUE),
total_in_category = sum(enrollment, na.rm = TRUE),
pct_weighted = 100 * total_in_category / total_enrollment_all,
.groups = "drop"
) |>
arrange(desc(pct_weighted))
weighted_pct
# Chunk 4
weighted_pct |>
ggplot(aes(x = reorder(category, pct_weighted), y = pct_weighted)) +
geom_col(fill = "steelblue") +
coord_flip() +
geom_text(aes(label = round(pct_weighted, 1)), hjust = -0.1) +
scale_y_continuous(limits = c(0, 100)) +
labs(
title = "Weighted National Enrollment by Category",
x = "Category",
y = "Percent of Total Enrollment"
) +
theme_bw()
# Chunk 5
ti <- tuition_income |>
filter(!is.na(net_cost), !is.na(total_price)) |>
mutate(pay_share = net_cost / total_price)
trend <- ti |>
group_by(year, income_lvl) |>
summarise(avg_share = mean(pay_share, na.rm = TRUE), .groups = "drop")
# Chunk 6
ggplot(trend, aes(x = year, y = avg_share, color = income_lvl)) +
geom_line(linewidth = 1.5) +
labs(
title = "Affordability Gap Over Time by Income Level",
x = "Year",
y = "Ratio of sticker price paid",
color = "Income bracket"
) +
theme_bw()
# Chunk 7
tc_summary <- tuition_cost |>
group_by(type) |>
summarise(
avg_in_state = mean(in_state_total, na.rm = TRUE),
avg_out_state = mean(out_of_state_total, na.rm = TRUE),
.groups = "drop"
)
tc_long <- tc_summary |>
pivot_longer(
cols = c(avg_in_state, avg_out_state),
names_to = "tuition_type",
values_to = "cost"
)
# Chunk 8
ggplot(tc_long, aes(x = type, y = cost, fill = tuition_type)) +
geom_col(position = "dodge") +
labs(
title = "Average Sticker Price by School Type",
x = "School type",
y = "Average total cost (USD)",
fill = "Tuition type"
) +
theme_bw()
# Chunk 9
historical_inf_timeline <- historical_tuition %>%
filter(tuition_type == "All Constant")
# Chunk 10
ggplot(historical_inf_timeline, aes(x = year, y = tuition_cost, colour = type)) +
geom_point() +
labs(
title = "Tuition Costs Over Time (Inflation-Adjusted)",
x = "Year",
y = "Tuition cost (inflation-adjusted USD)",
colour = "School type"
) +
theme_minimal()
# Chunk 11
historical_tuition_2yv4y <- historical_tuition %>%
filter(tuition_type %in% c("4 Year Constant", "2 Year Constant")) %>%
filter(year %in% c("1985-86", "1995-96", "2005-06", "2015-16")) %>%
mutate(year = factor(year, levels = c("1985-86", "1995-96", "2005-06", "2015-16")))
# Chunk 12
ggplot(historical_tuition_2yv4y,
aes(x = year, y = tuition_cost, fill = tuition_type)) +
geom_col(position = "dodge") +
facet_wrap(~type) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(
title = "Tuition Costs Over Time",
x = "Year",
y = "Tuition cost (inflation-adjusted USD)",
fill = "Tuition type"
)
# Chunk 13
ggplot(salary_potential,
aes(x = make_world_better_percent, y = mid_career_pay)) +
geom_point() +
labs(
title = "Salary vs Making the World a Better Place",
x = "Percent of alumni who think they are making the world a better place",
y = "Estimated mid-career pay in USD"
) +
theme_bw()
# Chunk 14
state_salary_potential <- salary_potential |>
group_by(state_name) |>
summarise(avg_mid_career_pay = mean(mid_career_pay, na.rm = TRUE), .groups = "drop")
# Chunk 15
library(maps)
state_df <- ggplot2::map_data("state")
state_salary_potential <- state_salary_potential |>
mutate(state_name = str_to_lower(state_name)) |>
mutate(state_name = str_replace_all(state_name, "-", " "))
# Chunk 16
state_full <- right_join(state_df, state_salary_potential, by = c("region" = "state_name"))
# Chunk 17
ggplot(state_full, aes(x = long, y = lat, group = group)) +
geom_polygon(colour = "black", aes(fill = avg_mid_career_pay)) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
scale_fill_viridis_c(option = "magma") +
theme_bw()
# Chunk 18
state_world_potential <- salary_potential |>
group_by(state_name) |>
summarise(avg_percent_world_postive = mean(make_world_better_percent, na.rm = TRUE), .groups = "drop")
# Chunk 19
library(maps)
state_df2 <- ggplot2::map_data("state")
state_world_potential <- state_world_potential |>
mutate(state_name = str_to_lower(state_name)) |>
mutate(state_name = str_replace_all(state_name, "-", " "))
# Chunk 20
state_full2 <- right_join(state_df2, state_world_potential, by = c("region" = "state_name"))
ggplot(state_full2, aes(x = long, y = lat, group = group)) +
geom_polygon(colour = "black", aes(fill = avg_percent_world_postive)) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
scale_fill_viridis_c(option = "magma") +
theme_bw()
library(maps)
state_df2 <- ggplot2::map_data("state")
state_world_potential <- state_world_potential |>
mutate(state_name = str_to_lower(state_name)) |>
mutate(state_name = str_replace_all(state_name, "-", " "))
weighted_pct |>
ggplot(aes(x = reorder(category, pct_weighted), y = pct_weighted)) +
geom_col(fill = "steelblue") +
coord_flip() +
geom_text(aes(label = round(pct_weighted, 1)), hjust = -0.1) +
scale_y_continuous(limits = c(0, 100)) +
labs(
title = "Weighted National Enrollment by Category",
x = "Category",
y = "Percent of Total Enrollment"
) +
theme_bw()
weighted_pct
ggplot(trend, aes(x = year, y = avg_share, color = income_lvl)) +
geom_line(linewidth = 1.5) +
labs(
title = "Affordability Gap Over Time by Income Level",
x = "Year",
y = "Ratio of sticker price paid",
color = "Income bracket"
) +
theme_bw()
ggplot(tc_long, aes(x = type, y = cost, fill = tuition_type)) +
geom_col(position = "dodge") +
labs(
title = "Average Sticker Price by School Type",
x = "School type",
y = "Average total cost (USD)",
fill = "Tuition type"
) +
theme_bw()
ggplot(historical_inf_timeline, aes(x = year, y = tuition_cost, colour = type)) +
geom_point() +
labs(
title = "Tuition Costs Over Time (Inflation-Adjusted)",
x = "Year",
y = "Tuition cost (inflation-adjusted USD)",
colour = "School type"
) +
theme_minimal()
ggplot(historical_tuition_2yv4y,
aes(x = year, y = tuition_cost, fill = tuition_type)) +
geom_col(position = "dodge") +
facet_wrap(~type) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(
title = "Tuition Costs Over Time",
x = "Year",
y = "Tuition cost (inflation-adjusted USD)",
fill = "Tuition type"
)
ggplot(tc_long, aes(x = type, y = cost, fill = tuition_type)) +
geom_col(position = "dodge") +
labs(
title = "Average Sticker Price by School Type",
x = "School type",
y = "Average total cost (USD)",
fill = "Tuition type"
) +
theme_bw()
tc_long
tuition_cost
